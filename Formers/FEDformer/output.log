Args in experiment:
Namespace(is_training=1, task_id='test', model='FEDformer', version='Fourier', mode_select='random', modes=64, L=3, base='legendre', cross_activation='tanh', data='ETTh1', root_path='./dataset', data_path='ETTh1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=[24], factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=100, batch_size=16, patience=3, learning_rate=0.0001, des='test', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1')
Use GPU: cuda:0
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 37, 38, 39, 41, 42, 43, 44, 45, 46, 47, 48, 49, 51, 52, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71]
 fourier enhanced cross attention used!
modes_q=64, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 68, 69, 71]
modes_kv=48, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47]
enc_modes: 48, dec_modes: 64
>>>>>>>start training : test_FEDformer_random_modes64_ETTh1_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
Epoch: 1 cost time: 114.579843044281
Epoch: 1, Steps: 528 | Train Loss: 0.4032529 Vali Loss: 0.7947450 Test Loss: 0.3801747
Validation loss decreased (inf --> 0.794745).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 109.30329537391663
Epoch: 2, Steps: 528 | Train Loss: 0.3636311 Vali Loss: 0.7902607 Test Loss: 0.3910925
Validation loss decreased (0.794745 --> 0.790261).  Saving model ...
Updating learning rate to 5e-05
Epoch: 3 cost time: 109.29915618896484
Epoch: 3, Steps: 528 | Train Loss: 0.3497692 Vali Loss: 0.7793449 Test Loss: 0.3842286
Validation loss decreased (0.790261 --> 0.779345).  Saving model ...
Updating learning rate to 2.5e-05
Epoch: 4 cost time: 109.24486064910889
Epoch: 4, Steps: 528 | Train Loss: 0.3433096 Vali Loss: 0.7834240 Test Loss: 0.3806042
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
Epoch: 5 cost time: 108.9971559047699
Epoch: 5, Steps: 528 | Train Loss: 0.3395921 Vali Loss: 0.7812538 Test Loss: 0.3802584
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
Epoch: 6 cost time: 114.99549460411072
Epoch: 6, Steps: 528 | Train Loss: 0.3374177 Vali Loss: 0.7801290 Test Loss: 0.3780163
EarlyStopping counter: 3 out of 3
Updating learning rate to 3.125e-06
Epoch: 7 cost time: 109.10812950134277
Epoch: 7, Steps: 528 | Train Loss: 0.3362105 Vali Loss: 0.7792990 Test Loss: 0.3782369
Validation loss decreased (0.779345 --> 0.779299).  Saving model ...
Updating learning rate to 1.5625e-06
Epoch: 8 cost time: 110.89005184173584
Epoch: 8, Steps: 528 | Train Loss: 0.3356337 Vali Loss: 0.7795426 Test Loss: 0.3785290
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
Epoch: 9 cost time: 111.15753507614136
Epoch: 9, Steps: 528 | Train Loss: 0.3352314 Vali Loss: 0.7786357 Test Loss: 0.3785585
Validation loss decreased (0.779299 --> 0.778636).  Saving model ...
Updating learning rate to 3.90625e-07
Epoch: 10 cost time: 108.9536702632904
Epoch: 10, Steps: 528 | Train Loss: 0.3351888 Vali Loss: 0.7792590 Test Loss: 0.3787239
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
Epoch: 11 cost time: 108.92531180381775
Epoch: 11, Steps: 528 | Train Loss: 0.3350458 Vali Loss: 0.7797248 Test Loss: 0.3786261
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-08
Epoch: 12 cost time: 108.96763730049133
Epoch: 12, Steps: 528 | Train Loss: 0.3350440 Vali Loss: 0.7795708 Test Loss: 0.3787784
EarlyStopping counter: 3 out of 3
Updating learning rate to 4.8828125e-08
Epoch: 13 cost time: 109.20115375518799
Epoch: 13, Steps: 528 | Train Loss: 0.3349859 Vali Loss: 0.7795615 Test Loss: 0.3787335
EarlyStopping counter: 4 out of 3
Updating learning rate to 2.44140625e-08
Epoch: 14 cost time: 109.29552698135376
Epoch: 14, Steps: 528 | Train Loss: 0.3350699 Vali Loss: 0.7797374 Test Loss: 0.3787262
EarlyStopping counter: 5 out of 3
Updating learning rate to 1.220703125e-08
Epoch: 15 cost time: 109.14021873474121
Epoch: 15, Steps: 528 | Train Loss: 0.3350312 Vali Loss: 0.7797803 Test Loss: 0.3787234
EarlyStopping counter: 6 out of 3
Updating learning rate to 6.103515625e-09
Epoch: 16 cost time: 115.75460171699524
Epoch: 16, Steps: 528 | Train Loss: 0.3349594 Vali Loss: 0.7797797 Test Loss: 0.3787222
EarlyStopping counter: 7 out of 3
Updating learning rate to 3.0517578125e-09
Epoch: 17 cost time: 115.3129403591156
Epoch: 17, Steps: 528 | Train Loss: 0.3349838 Vali Loss: 0.7796873 Test Loss: 0.3787211
EarlyStopping counter: 8 out of 3
Updating learning rate to 1.52587890625e-09
Epoch: 18 cost time: 109.22392988204956
Epoch: 18, Steps: 528 | Train Loss: 0.3350692 Vali Loss: 0.7797087 Test Loss: 0.3787205
EarlyStopping counter: 9 out of 3
Updating learning rate to 7.62939453125e-10
Epoch: 19 cost time: 107.37907648086548
Epoch: 19, Steps: 528 | Train Loss: 0.3349611 Vali Loss: 0.7797375 Test Loss: 0.3787205
EarlyStopping counter: 10 out of 3
Updating learning rate to 3.814697265625e-10
Epoch: 20 cost time: 103.19728112220764
Epoch: 20, Steps: 528 | Train Loss: 0.3350167 Vali Loss: 0.7794517 Test Loss: 0.3787205
EarlyStopping counter: 11 out of 3
Updating learning rate to 1.9073486328125e-10
Epoch: 21 cost time: 100.3584213256836
Epoch: 21, Steps: 528 | Train Loss: 0.3349714 Vali Loss: 0.7796452 Test Loss: 0.3787204
EarlyStopping counter: 12 out of 3
Updating learning rate to 9.5367431640625e-11
Epoch: 22 cost time: 99.81808614730835
Epoch: 22, Steps: 528 | Train Loss: 0.3349866 Vali Loss: 0.7796724 Test Loss: 0.3787204
EarlyStopping counter: 13 out of 3
Updating learning rate to 4.76837158203125e-11
Epoch: 23 cost time: 101.03643131256104
Epoch: 23, Steps: 528 | Train Loss: 0.3349740 Vali Loss: 0.7796147 Test Loss: 0.3787204
EarlyStopping counter: 14 out of 3
Updating learning rate to 2.384185791015625e-11
Epoch: 24 cost time: 99.75092697143555
Epoch: 24, Steps: 528 | Train Loss: 0.3349552 Vali Loss: 0.7797531 Test Loss: 0.3787204
EarlyStopping counter: 15 out of 3
Updating learning rate to 1.1920928955078126e-11
Epoch: 25 cost time: 109.21119093894958
Epoch: 25, Steps: 528 | Train Loss: 0.3349758 Vali Loss: 0.7794863 Test Loss: 0.3787204
EarlyStopping counter: 16 out of 3
Updating learning rate to 5.960464477539063e-12
Epoch: 26 cost time: 109.19368481636047
Epoch: 26, Steps: 528 | Train Loss: 0.3349885 Vali Loss: 0.7797654 Test Loss: 0.3787204
EarlyStopping counter: 17 out of 3
Updating learning rate to 2.9802322387695314e-12
Epoch: 27 cost time: 108.96414303779602
Epoch: 27, Steps: 528 | Train Loss: 0.3350252 Vali Loss: 0.7796715 Test Loss: 0.3787204
EarlyStopping counter: 18 out of 3
Updating learning rate to 1.4901161193847657e-12
Epoch: 28 cost time: 109.46055245399475
Epoch: 28, Steps: 528 | Train Loss: 0.3349924 Vali Loss: 0.7797464 Test Loss: 0.3787204
EarlyStopping counter: 19 out of 3
Updating learning rate to 7.450580596923828e-13
Epoch: 29 cost time: 109.01340866088867
Epoch: 29, Steps: 528 | Train Loss: 0.3349722 Vali Loss: 0.7795801 Test Loss: 0.3787204
EarlyStopping counter: 20 out of 3
Updating learning rate to 3.725290298461914e-13
Epoch: 30 cost time: 108.98803901672363
Epoch: 30, Steps: 528 | Train Loss: 0.3350147 Vali Loss: 0.7794037 Test Loss: 0.3787204
EarlyStopping counter: 21 out of 3
Updating learning rate to 1.862645149230957e-13
Epoch: 31 cost time: 108.9780821800232
Epoch: 31, Steps: 528 | Train Loss: 0.3349156 Vali Loss: 0.7790568 Test Loss: 0.3787204
EarlyStopping counter: 22 out of 3
Updating learning rate to 9.313225746154786e-14
Epoch: 32 cost time: 109.01520943641663
Epoch: 32, Steps: 528 | Train Loss: 0.3349787 Vali Loss: 0.7794207 Test Loss: 0.3787204
EarlyStopping counter: 23 out of 3
Updating learning rate to 4.656612873077393e-14
Epoch: 33 cost time: 109.12644410133362
Epoch: 33, Steps: 528 | Train Loss: 0.3350091 Vali Loss: 0.7797146 Test Loss: 0.3787204
EarlyStopping counter: 24 out of 3
Updating learning rate to 2.3283064365386964e-14
Epoch: 34 cost time: 109.60113096237183
Epoch: 34, Steps: 528 | Train Loss: 0.3350352 Vali Loss: 0.7796264 Test Loss: 0.3787204
EarlyStopping counter: 25 out of 3
Updating learning rate to 1.1641532182693482e-14
Epoch: 35 cost time: 109.1071388721466
Epoch: 35, Steps: 528 | Train Loss: 0.3350212 Vali Loss: 0.7797312 Test Loss: 0.3787204
EarlyStopping counter: 26 out of 3
Updating learning rate to 5.820766091346741e-15
Epoch: 36 cost time: 108.96905279159546
Epoch: 36, Steps: 528 | Train Loss: 0.3349208 Vali Loss: 0.7797604 Test Loss: 0.3787204
EarlyStopping counter: 27 out of 3
Updating learning rate to 2.9103830456733705e-15
Epoch: 37 cost time: 109.18600130081177
Epoch: 37, Steps: 528 | Train Loss: 0.3350379 Vali Loss: 0.7797098 Test Loss: 0.3787204
EarlyStopping counter: 28 out of 3
Updating learning rate to 1.4551915228366853e-15
Epoch: 38 cost time: 115.5899441242218
Epoch: 38, Steps: 528 | Train Loss: 0.3349317 Vali Loss: 0.7797509 Test Loss: 0.3787204
EarlyStopping counter: 29 out of 3
Updating learning rate to 7.275957614183426e-16
Epoch: 39 cost time: 115.60545492172241
Epoch: 39, Steps: 528 | Train Loss: 0.3350117 Vali Loss: 0.7797703 Test Loss: 0.3787204
EarlyStopping counter: 30 out of 3
Updating learning rate to 3.637978807091713e-16
Epoch: 40 cost time: 110.2878646850586
Epoch: 40, Steps: 528 | Train Loss: 0.3349195 Vali Loss: 0.7794212 Test Loss: 0.3787204
EarlyStopping counter: 31 out of 3
Updating learning rate to 1.8189894035458566e-16
Epoch: 41 cost time: 109.09388279914856
Epoch: 41, Steps: 528 | Train Loss: 0.3349658 Vali Loss: 0.7798364 Test Loss: 0.3787204
EarlyStopping counter: 32 out of 3
Updating learning rate to 9.094947017729283e-17
Epoch: 42 cost time: 109.10050415992737
Epoch: 42, Steps: 528 | Train Loss: 0.3349921 Vali Loss: 0.7794512 Test Loss: 0.3787204
EarlyStopping counter: 33 out of 3
Updating learning rate to 4.5474735088646414e-17
Epoch: 43 cost time: 108.9959557056427
Epoch: 43, Steps: 528 | Train Loss: 0.3349598 Vali Loss: 0.7791301 Test Loss: 0.3787204
EarlyStopping counter: 34 out of 3
Updating learning rate to 2.2737367544323207e-17
Epoch: 44 cost time: 109.0581865310669
Epoch: 44, Steps: 528 | Train Loss: 0.3349953 Vali Loss: 0.7797053 Test Loss: 0.3787204
EarlyStopping counter: 35 out of 3
Updating learning rate to 1.1368683772161604e-17
Epoch: 45 cost time: 109.24601459503174
Epoch: 45, Steps: 528 | Train Loss: 0.3350078 Vali Loss: 0.7798256 Test Loss: 0.3787204
EarlyStopping counter: 36 out of 3
Updating learning rate to 5.684341886080802e-18
Epoch: 46 cost time: 109.37346649169922
Epoch: 46, Steps: 528 | Train Loss: 0.3349780 Vali Loss: 0.7796028 Test Loss: 0.3787204
EarlyStopping counter: 37 out of 3
Updating learning rate to 2.842170943040401e-18
Epoch: 47 cost time: 109.19002294540405
Epoch: 47, Steps: 528 | Train Loss: 0.3350822 Vali Loss: 0.7795171 Test Loss: 0.3787204
EarlyStopping counter: 38 out of 3
Updating learning rate to 1.4210854715202004e-18
Epoch: 48 cost time: 109.30043649673462
Epoch: 48, Steps: 528 | Train Loss: 0.3350115 Vali Loss: 0.7796701 Test Loss: 0.3787204
EarlyStopping counter: 39 out of 3
Updating learning rate to 7.105427357601002e-19
Epoch: 49 cost time: 109.27389073371887
Epoch: 49, Steps: 528 | Train Loss: 0.3349869 Vali Loss: 0.7797711 Test Loss: 0.3787204
EarlyStopping counter: 40 out of 3
Updating learning rate to 3.552713678800501e-19
Epoch: 50 cost time: 109.28474879264832
Epoch: 50, Steps: 528 | Train Loss: 0.3349883 Vali Loss: 0.7797713 Test Loss: 0.3787204
EarlyStopping counter: 41 out of 3
Updating learning rate to 1.7763568394002505e-19
Epoch: 51 cost time: 109.22007584571838
Epoch: 51, Steps: 528 | Train Loss: 0.3350560 Vali Loss: 0.7796983 Test Loss: 0.3787204
EarlyStopping counter: 42 out of 3
Updating learning rate to 8.881784197001253e-20
Epoch: 52 cost time: 109.31507110595703
Epoch: 52, Steps: 528 | Train Loss: 0.3349653 Vali Loss: 0.7796158 Test Loss: 0.3787204
EarlyStopping counter: 43 out of 3
Updating learning rate to 4.4408920985006264e-20
Epoch: 53 cost time: 109.30287194252014
Epoch: 53, Steps: 528 | Train Loss: 0.3349749 Vali Loss: 0.7798192 Test Loss: 0.3787204
EarlyStopping counter: 44 out of 3
Updating learning rate to 2.2204460492503132e-20
Epoch: 54 cost time: 110.24317049980164
Epoch: 54, Steps: 528 | Train Loss: 0.3349889 Vali Loss: 0.7789500 Test Loss: 0.3787204
EarlyStopping counter: 45 out of 3
Updating learning rate to 1.1102230246251566e-20
Epoch: 55 cost time: 114.40079140663147
Epoch: 55, Steps: 528 | Train Loss: 0.3350350 Vali Loss: 0.7793821 Test Loss: 0.3787204
EarlyStopping counter: 46 out of 3
Updating learning rate to 5.551115123125783e-21
Epoch: 56 cost time: 109.68663454055786
Epoch: 56, Steps: 528 | Train Loss: 0.3349960 Vali Loss: 0.7794235 Test Loss: 0.3787204
EarlyStopping counter: 47 out of 3
Updating learning rate to 2.7755575615628915e-21
Epoch: 57 cost time: 109.2291030883789
Epoch: 57, Steps: 528 | Train Loss: 0.3349017 Vali Loss: 0.7794671 Test Loss: 0.3787204
EarlyStopping counter: 48 out of 3
Updating learning rate to 1.3877787807814457e-21
Epoch: 58 cost time: 109.17959356307983
Epoch: 58, Steps: 528 | Train Loss: 0.3349735 Vali Loss: 0.7797168 Test Loss: 0.3787204
EarlyStopping counter: 49 out of 3
Updating learning rate to 6.938893903907229e-22
Epoch: 59 cost time: 109.19633460044861
Epoch: 59, Steps: 528 | Train Loss: 0.3349929 Vali Loss: 0.7798166 Test Loss: 0.3787204
EarlyStopping counter: 50 out of 3
Updating learning rate to 3.4694469519536144e-22
Epoch: 60 cost time: 109.26111245155334
Epoch: 60, Steps: 528 | Train Loss: 0.3349556 Vali Loss: 0.7797481 Test Loss: 0.3787204
EarlyStopping counter: 51 out of 3
Updating learning rate to 1.7347234759768072e-22
Epoch: 61 cost time: 109.40565824508667
Epoch: 61, Steps: 528 | Train Loss: 0.3349510 Vali Loss: 0.7797081 Test Loss: 0.3787204
EarlyStopping counter: 52 out of 3
Updating learning rate to 8.673617379884036e-23
Epoch: 62 cost time: 109.38745093345642
Epoch: 62, Steps: 528 | Train Loss: 0.3350008 Vali Loss: 0.7797459 Test Loss: 0.3787204
EarlyStopping counter: 53 out of 3
Updating learning rate to 4.336808689942018e-23
Epoch: 63 cost time: 102.3511106967926
Epoch: 63, Steps: 528 | Train Loss: 0.3350175 Vali Loss: 0.7796701 Test Loss: 0.3787204
EarlyStopping counter: 54 out of 3
Updating learning rate to 2.168404344971009e-23
Epoch: 64 cost time: 100.5575852394104
Epoch: 64, Steps: 528 | Train Loss: 0.3350218 Vali Loss: 0.7797148 Test Loss: 0.3787204
EarlyStopping counter: 55 out of 3
Updating learning rate to 1.0842021724855045e-23
Epoch: 65 cost time: 101.6232578754425
Epoch: 65, Steps: 528 | Train Loss: 0.3350513 Vali Loss: 0.7793962 Test Loss: 0.3787204
EarlyStopping counter: 56 out of 3
Updating learning rate to 5.4210108624275224e-24
Epoch: 66 cost time: 102.19592356681824
Epoch: 66, Steps: 528 | Train Loss: 0.3349695 Vali Loss: 0.7797662 Test Loss: 0.3787204
EarlyStopping counter: 57 out of 3
Updating learning rate to 2.7105054312137612e-24
Epoch: 67 cost time: 103.133460521698
Epoch: 67, Steps: 528 | Train Loss: 0.3350088 Vali Loss: 0.7797236 Test Loss: 0.3787204
EarlyStopping counter: 58 out of 3
Updating learning rate to 1.3552527156068806e-24
Epoch: 68 cost time: 112.41200160980225
Epoch: 68, Steps: 528 | Train Loss: 0.3350260 Vali Loss: 0.7794290 Test Loss: 0.3787204
EarlyStopping counter: 59 out of 3
Updating learning rate to 6.776263578034403e-25
Epoch: 69 cost time: 110.76201152801514
Epoch: 69, Steps: 528 | Train Loss: 0.3349425 Vali Loss: 0.7792122 Test Loss: 0.3787204
EarlyStopping counter: 60 out of 3
Updating learning rate to 3.3881317890172015e-25
Epoch: 70 cost time: 110.0375018119812
Epoch: 70, Steps: 528 | Train Loss: 0.3349699 Vali Loss: 0.7796718 Test Loss: 0.3787204
EarlyStopping counter: 61 out of 3
Updating learning rate to 1.6940658945086008e-25
Epoch: 71 cost time: 110.00380301475525
Epoch: 71, Steps: 528 | Train Loss: 0.3349893 Vali Loss: 0.7797375 Test Loss: 0.3787204
EarlyStopping counter: 62 out of 3
Updating learning rate to 8.470329472543004e-26
Epoch: 72 cost time: 109.97850728034973
Epoch: 72, Steps: 528 | Train Loss: 0.3349930 Vali Loss: 0.7797779 Test Loss: 0.3787204
EarlyStopping counter: 63 out of 3
Updating learning rate to 4.235164736271502e-26
Epoch: 73 cost time: 110.02017712593079
Epoch: 73, Steps: 528 | Train Loss: 0.3349748 Vali Loss: 0.7797502 Test Loss: 0.3787204
EarlyStopping counter: 64 out of 3
Updating learning rate to 2.117582368135751e-26
Epoch: 74 cost time: 109.89351511001587
Epoch: 74, Steps: 528 | Train Loss: 0.3349723 Vali Loss: 0.7797812 Test Loss: 0.3787204
EarlyStopping counter: 65 out of 3
Updating learning rate to 1.0587911840678755e-26
Epoch: 75 cost time: 110.00719714164734
Epoch: 75, Steps: 528 | Train Loss: 0.3349715 Vali Loss: 0.7790456 Test Loss: 0.3787204
EarlyStopping counter: 66 out of 3
Updating learning rate to 5.2939559203393774e-27
Epoch: 76 cost time: 112.75107169151306
Epoch: 76, Steps: 528 | Train Loss: 0.3350569 Vali Loss: 0.7795153 Test Loss: 0.3787204
EarlyStopping counter: 67 out of 3
Updating learning rate to 2.6469779601696887e-27
Epoch: 77 cost time: 116.25128841400146
Epoch: 77, Steps: 528 | Train Loss: 0.3349912 Vali Loss: 0.7793695 Test Loss: 0.3787204
EarlyStopping counter: 68 out of 3
Updating learning rate to 1.3234889800848443e-27
Epoch: 78 cost time: 116.37790989875793
Epoch: 78, Steps: 528 | Train Loss: 0.3350287 Vali Loss: 0.7796699 Test Loss: 0.3787204
EarlyStopping counter: 69 out of 3
Updating learning rate to 6.617444900424222e-28
Epoch: 79 cost time: 116.6978371143341
Epoch: 79, Steps: 528 | Train Loss: 0.3350170 Vali Loss: 0.7790228 Test Loss: 0.3787204
EarlyStopping counter: 70 out of 3
Updating learning rate to 3.308722450212111e-28
Epoch: 80 cost time: 116.42487001419067
Epoch: 80, Steps: 528 | Train Loss: 0.3349917 Vali Loss: 0.7786974 Test Loss: 0.3787204
EarlyStopping counter: 71 out of 3
Updating learning rate to 1.6543612251060554e-28
Epoch: 81 cost time: 111.37236261367798
Epoch: 81, Steps: 528 | Train Loss: 0.3350622 Vali Loss: 0.7796748 Test Loss: 0.3787204
EarlyStopping counter: 72 out of 3
Updating learning rate to 8.271806125530277e-29
Epoch: 82 cost time: 109.65713500976562
Epoch: 82, Steps: 528 | Train Loss: 0.3350467 Vali Loss: 0.7796494 Test Loss: 0.3787204
EarlyStopping counter: 73 out of 3
Updating learning rate to 4.1359030627651386e-29
Epoch: 83 cost time: 109.6770236492157
Epoch: 83, Steps: 528 | Train Loss: 0.3349300 Vali Loss: 0.7794329 Test Loss: 0.3787204
EarlyStopping counter: 74 out of 3
Updating learning rate to 2.0679515313825693e-29
Epoch: 84 cost time: 116.67388248443604
Epoch: 84, Steps: 528 | Train Loss: 0.3350542 Vali Loss: 0.7796401 Test Loss: 0.3787204
EarlyStopping counter: 75 out of 3
Updating learning rate to 1.0339757656912846e-29
Epoch: 85 cost time: 113.62945556640625
Epoch: 85, Steps: 528 | Train Loss: 0.3348850 Vali Loss: 0.7797514 Test Loss: 0.3787204
EarlyStopping counter: 76 out of 3
Updating learning rate to 5.169878828456423e-30
Epoch: 86 cost time: 109.70094418525696
Epoch: 86, Steps: 528 | Train Loss: 0.3349839 Vali Loss: 0.7797862 Test Loss: 0.3787204
EarlyStopping counter: 77 out of 3
Updating learning rate to 2.5849394142282116e-30
Epoch: 87 cost time: 109.73317050933838
Epoch: 87, Steps: 528 | Train Loss: 0.3349353 Vali Loss: 0.7797623 Test Loss: 0.3787204
EarlyStopping counter: 78 out of 3
Updating learning rate to 1.2924697071141058e-30
Epoch: 88 cost time: 109.7104320526123
Epoch: 88, Steps: 528 | Train Loss: 0.3349639 Vali Loss: 0.7793628 Test Loss: 0.3787204
EarlyStopping counter: 79 out of 3
Updating learning rate to 6.462348535570529e-31
Epoch: 89 cost time: 109.79667901992798
Epoch: 89, Steps: 528 | Train Loss: 0.3349646 Vali Loss: 0.7798188 Test Loss: 0.3787204
EarlyStopping counter: 80 out of 3
Updating learning rate to 3.2311742677852645e-31
Epoch: 90 cost time: 109.7116334438324
Epoch: 90, Steps: 528 | Train Loss: 0.3350127 Vali Loss: 0.7797476 Test Loss: 0.3787204
EarlyStopping counter: 81 out of 3
Updating learning rate to 1.6155871338926323e-31
Epoch: 91 cost time: 113.58430695533752
Epoch: 91, Steps: 528 | Train Loss: 0.3350329 Vali Loss: 0.7792895 Test Loss: 0.3787204
EarlyStopping counter: 82 out of 3
Updating learning rate to 8.077935669463161e-32
Epoch: 92 cost time: 115.84261989593506
Epoch: 92, Steps: 528 | Train Loss: 0.3349951 Vali Loss: 0.7797222 Test Loss: 0.3787204
EarlyStopping counter: 83 out of 3
Updating learning rate to 4.0389678347315806e-32
Epoch: 93 cost time: 115.99107193946838
Epoch: 93, Steps: 528 | Train Loss: 0.3348917 Vali Loss: 0.7795618 Test Loss: 0.3787204
EarlyStopping counter: 84 out of 3
Updating learning rate to 2.0194839173657903e-32
Epoch: 94 cost time: 116.26557803153992
Epoch: 94, Steps: 528 | Train Loss: 0.3349717 Vali Loss: 0.7794539 Test Loss: 0.3787204
EarlyStopping counter: 85 out of 3
Updating learning rate to 1.0097419586828952e-32
Epoch: 95 cost time: 114.13966846466064
Epoch: 95, Steps: 528 | Train Loss: 0.3350135 Vali Loss: 0.7797734 Test Loss: 0.3787204
EarlyStopping counter: 86 out of 3
Updating learning rate to 5.048709793414476e-33
Epoch: 96 cost time: 109.61826086044312
Epoch: 96, Steps: 528 | Train Loss: 0.3349704 Vali Loss: 0.7797074 Test Loss: 0.3787204
EarlyStopping counter: 87 out of 3
Updating learning rate to 2.524354896707238e-33
Epoch: 97 cost time: 109.66061615943909
Epoch: 97, Steps: 528 | Train Loss: 0.3350094 Vali Loss: 0.7795959 Test Loss: 0.3787204
EarlyStopping counter: 88 out of 3
Updating learning rate to 1.262177448353619e-33
Epoch: 98 cost time: 109.67738008499146
Epoch: 98, Steps: 528 | Train Loss: 0.3350039 Vali Loss: 0.7796742 Test Loss: 0.3787204
EarlyStopping counter: 89 out of 3
Updating learning rate to 6.310887241768095e-34
Epoch: 99 cost time: 109.71682143211365
Epoch: 99, Steps: 528 | Train Loss: 0.3349782 Vali Loss: 0.7796100 Test Loss: 0.3787204
EarlyStopping counter: 90 out of 3
Updating learning rate to 3.1554436208840474e-34
Epoch: 100 cost time: 109.74733877182007
Epoch: 100, Steps: 528 | Train Loss: 0.3350050 Vali Loss: 0.7796966 Test Loss: 0.3787204
EarlyStopping counter: 91 out of 3
Updating learning rate to 1.5777218104420237e-34
>>>>>>>testing : test_FEDformer_random_modes64_ETTh1_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (174, 16, 96, 7) (174, 16, 96, 7)
test shape: (2784, 96, 7) (2784, 96, 7)
mse:0.37855833768844604, mae:0.4152853190898895
